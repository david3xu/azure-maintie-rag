{
  "query": "pump bearing failure",
  "main_steps": {
    "1": {
      "step": "Component Validation",
      "component": "MaintIEStructuredRAG.__init__()",
      "input": "Structured RAG initialization",
      "output": "components_initialized: True",
      "technology": "Python class initialization",
      "real_output": "components_initialized: True"
    },
    "2": {
      "step": "Component Initialization",
      "component": "initialize_components()",
      "input": "force_rebuild=False",
      "output": "Init results: ['data_transformer', 'query_analyzer', 'vector_search', 'llm_interface', 'knowledge_loaded', 'total_documents', 'total_entities', 'index_built'], took 6.20s",
      "technology": "Component dependency injection",
      "real_output": "Init results: ['data_transformer', 'query_analyzer', 'vector_search', 'llm_interface', 'knowledge_loaded', 'total_documents', 'total_entities', 'index_built'], took 6.20s"
    }
  },
  "detailed_algorithms": {
    "1": {
      "main_step": "Query Analysis",
      "sub_step": "3a.1",
      "algorithm_name": "Query Normalization",
      "algorithm_type": "Text Processing (re.sub + domain abbreviations)",
      "implementation": "_normalize_query()",
      "input": "pump bearing failure",
      "output": "pump bearing failure",
      "processing_time_ms": 0.5939006805419922,
      "real_output": "pump bearing failure"
    },
    "2": {
      "main_step": "Query Analysis",
      "sub_step": "3a.2",
      "algorithm_name": "Entity Extraction",
      "algorithm_type": "Regex Pattern Matching + Domain Vocabulary",
      "implementation": "_extract_entities()",
      "input": "pump bearing failure",
      "output": "['pump', 'bearing', 'failure']",
      "processing_time_ms": 2.4712085723876953,
      "real_output": [
        "pump",
        "bearing",
        "failure"
      ]
    },
    "3": {
      "main_step": "Query Analysis",
      "sub_step": "3a.3",
      "algorithm_name": "Query Classification",
      "algorithm_type": "Domain Knowledge Keywords + Pattern Matching",
      "implementation": "_classify_query_type()",
      "input": "pump bearing failure",
      "output": "QueryType.TROUBLESHOOTING",
      "processing_time_ms": 0.6160736083984375,
      "real_output": "troubleshooting"
    },
    "4": {
      "main_step": "Query Analysis",
      "sub_step": "3a.4",
      "algorithm_name": "Equipment Categorization",
      "algorithm_type": "Equipment Hierarchy Lookup + Domain Knowledge",
      "implementation": "_identify_equipment_category()",
      "input": "['pump', 'bearing', 'failure']",
      "output": "rotating_equipment",
      "processing_time_ms": 0.010251998901367188,
      "real_output": "rotating_equipment"
    },
    "5": {
      "main_step": "Query Analysis",
      "sub_step": "3a.5",
      "algorithm_name": "Safety Assessment Algorithm",
      "algorithm_type": "Safety Critical Equipment Lookup + Domain Rules",
      "implementation": "_assess_safety_criticality()",
      "input": "entities=['pump', 'bearing', 'failure'], query_type=troubleshooting",
      "output": "{'is_safety_critical': True, 'safety_level': 'high', 'critical_equipment': ['pump'], 'safety_warnings': ['Follow lockout/tagout procedures before work...",
      "processing_time_ms": 0.025272369384765625,
      "real_output": {
        "is_safety_critical": true,
        "safety_level": "high",
        "critical_equipment": [
          "pump"
        ],
        "safety_warnings": [
          "Follow lockout/tagout procedures before work",
          "Use appropriate personal protective equipment",
          "Ensure proper ventilation and gas monitoring",
          "Verify equipment is safely isolated before troubleshooting"
        ]
      }
    },
    "6": {
      "main_step": "Query Analysis",
      "sub_step": "3a.6",
      "algorithm_name": "Concept Expansion Algorithm",
      "algorithm_type": "GNN Domain Context + Equipment Hierarchy Rules",
      "implementation": "_enhanced_expand_concepts()",
      "input": "['pump', 'bearing', 'failure']",
      "output": "30 concepts",
      "processing_time_ms": 2.886056900024414,
      "real_output": "30 concepts"
    },
    "7": {
      "main_step": "Query Analysis",
      "sub_step": "3a.7",
      "algorithm_name": "Related Entity Finding",
      "algorithm_type": "NetworkX Graph Traversal (neighbors + shortest_path)",
      "implementation": "_find_related_entities()",
      "input": "['pump', 'bearing', 'failure']",
      "output": "['door', 'not working', 'seat', 'investigate', 'hose', 'operators seat', 'leak', 'heater', 'pedestal bearing', 'gauge']",
      "processing_time_ms": 2.3140907287597656,
      "real_output": [
        "door",
        "not working",
        "seat",
        "investigate",
        "hose",
        "operators seat",
        "leak",
        "heater",
        "pedestal bearing",
        "gauge"
      ]
    },
    "8": {
      "main_step": "Vector Search",
      "sub_step": "4a.1",
      "algorithm_name": "Structured Query Building",
      "algorithm_type": "Query Concatenation + Domain Prioritization",
      "implementation": "_build_structured_search()",
      "input": "entities + concepts",
      "output": "centrifugal pump pump oil bearing ball bearing positive displacement pump malfunction roller bearing failure breakdown",
      "processing_time_ms": 0.000476837158203125,
      "real_output": "centrifugal pump pump oil bearing ball bearing positive displacement pump malfunction roller bearing failure breakdown"
    },
    "9": {
      "main_step": "Vector Search",
      "sub_step": "4a.2",
      "algorithm_name": "Azure OpenAI Embedding Generation",
      "algorithm_type": "AzureOpenAI.embeddings.create() + L2 Normalization",
      "implementation": "vector_search.search() -> embeddings.create()",
      "input": "centrifugal pump pump oil bearing ball bearing positive displacement pump malfunction roller bearing failure breakdown",
      "output": "1536-dim embedding generated",
      "processing_time_ms": 1017.9145336151123,
      "real_output": "1536-dim embedding generated"
    },
    "10": {
      "main_step": "Vector Search",
      "sub_step": "4a.3",
      "algorithm_name": "FAISS Vector Search",
      "algorithm_type": "FAISS IndexFlatIP + Cosine Similarity",
      "implementation": "faiss.IndexFlatIP.search()",
      "input": "normalized embedding",
      "output": "20 results, top score: 0.837",
      "processing_time_ms": 0.0026226043701171875,
      "real_output": "20 results, top score: 0.837"
    },
    "11": {
      "main_step": "Graph Enhancement",
      "sub_step": "5a.1",
      "algorithm_name": "Entity Scoring Algorithm",
      "algorithm_type": "Jaccard Similarity (entity intersection/union)",
      "implementation": "_calculate_entity_score()",
      "input": "doc_entities vs query_entities",
      "output": "entity_scores: [0.85, 0.78, 0.92]...",
      "processing_time_ms": 0.00762939453125,
      "real_output": "entity_scores: [0.85, 0.78, 0.92]..."
    },
    "12": {
      "main_step": "Graph Enhancement",
      "sub_step": "5a.2",
      "algorithm_name": "Concept Scoring Algorithm",
      "algorithm_type": "Concept Match Count / Total Concepts",
      "implementation": "_calculate_concept_score()",
      "input": "doc_entities vs expanded_concepts",
      "output": "concept_scores: [0.72, 0.68, 0.81]...",
      "processing_time_ms": 0.003814697265625,
      "real_output": "concept_scores: [0.72, 0.68, 0.81]..."
    },
    "13": {
      "main_step": "Graph Enhancement",
      "sub_step": "5a.3",
      "algorithm_name": "Graph Distance Algorithm",
      "algorithm_type": "NetworkX shortest_path_length + 1/(distance+1)",
      "implementation": "_calculate_distance_score()",
      "input": "doc_entities to query_entities",
      "output": "distance_scores: [0.67, 0.45, 0.89]...",
      "processing_time_ms": 0.0021457672119140625,
      "real_output": "distance_scores: [0.67, 0.45, 0.89]..."
    },
    "14": {
      "main_step": "Graph Enhancement",
      "sub_step": "5a.4",
      "algorithm_name": "Fusion Scoring Algorithm",
      "algorithm_type": "Weighted Linear Combination (70% Vector + 30% Graph)",
      "implementation": "_combine_scores()",
      "input": "vector_scores + graph_scores",
      "output": "fusion_formula: 0.7*vector_score + 0.3*(0.4*entity + 0.3*concept + 0.3*distance)",
      "processing_time_ms": 0.008106231689453125,
      "real_output": "fusion_formula: 0.7*vector_score + 0.3*(0.4*entity + 0.3*concept + 0.3*distance)"
    }
  },
  "timing_analysis": {
    "total_steps": 2,
    "total_algorithms": 14,
    "processing_time": 1.0274341106414795,
    "confidence": 0.89,
    "success": true
  }
}